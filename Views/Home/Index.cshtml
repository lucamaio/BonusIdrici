@using System.Net
@using Microsoft.EntityFrameworkCore.Metadata.Internal
@{
    ViewData["Title"] = "Pannello di Controllo";
    var tema = ViewBag.Tema;
    /* 
        Restituisco gli indirizzi IP del server
        IPHostEntry ipEntry = Dns.GetHostEntry(Dns.GetHostName());
        IPAddress[] addr = ipEntry.AddressList;

        for (int i = 0; i < addr.Length; i++) {
            Console.WriteLine("IP Address {0}: {1} ", i, addr[i].ToString());
        } */

    // Prova invio email
    @* var email = new Models.Email("maiolucaangelo00@gmail.com","Test Email","Questa è una email di prova inviata dal sistema Bonus Idrici.");
    Console.WriteLine("Invio email di prova:");
    Console.WriteLine(email.ToString());
    email.Invia(); *@
}
@* <style>
    .btn-darkmode {
        position: absolute;
        top: 20px;
        right: 30px;
        border-radius: 50%;
        padding: 0.6rem 0.8rem;
        transition: background-color 0.3s, transform 0.3s;
    }

    .btn-darkmode:hover {
        background-color: #0d6efd;
        color: #fff;
        transform: scale(1.05);
    }

    .page-header {
        position: relative;
    }

    .page-header h1 {
        font-size: 2.4rem;
        letter-spacing: 0.5px;
        color: #1c1c1c;
    }

    .page-header::after {
        content: "";
        display: block;
        width: 60px;
        height: 4px;
        background-color: #0d6efd;
        margin: 1rem auto 0;
        border-radius: 2px;
    }

    .card-home {
        border: none;
        border-radius: 1rem;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .card-home:hover {
        transform: translateY(-4px);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
    }

    .icon-circle {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        font-size: 1.4rem;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Tema scuro */
    body.dark-mode {
        background-color: #1a1a1a;
        color: #e9ecef;
    }

    body.dark-mode .card-home {
        background-color: #2b2b2b;
        color: #e9ecef;
    }

    body.dark-mode .page-header h1,
    body.dark-mode .card-title {
        color: #f8f9fa;
    }

    body.dark-mode .card-text {
        color: #adb5bd;
    }
</style> *@
@* <button id="toggleDarkMode" class="btn btn-outline-secondary btn-darkmode" title="Cambia tema">
    <i class="bi bi-moon-stars" id="darkIcon"></i>
</button> *@

 <div class="main-content d-flex flex-column min-vh-100">
    <!-- HEADER -->
    <div class="text-center py-5 mb-4 page-header">
        <h1 class="display-5 fw-bold">Benvenuto nel Pannello di Controllo</h1>
        <p class="lead mb-0">Scegli una delle funzionalità per iniziare a lavorare.</p>
        @* <span>@tema</span> *@
    </div>

    <!-- FUNZIONALITÀ -->
    <div class="row g-4 mb-auto">
        <!-- Anagrafe -->
        <div class="col-md-6 col-lg-4">
            <a asp-controller="Anagrafe" asp-action="Index" class="text-decoration-none text-reset">
                <div class="card card-home h-100 shadow-sm">
                    <div class="card-body d-flex flex-column p-4">
                        <div class="d-flex align-items-center mb-3">
                            <div class="icon-circle bg-success text-white me-3">
                                <i class="fas fa-address-card"></i>
                            </div>
                            <h5 class="card-title mb-0">Anagrafe</h5>
                        </div>
                        <p class="card-text text-muted mt-auto">
                            Gestisci e consulta i dati anagrafici relativi al ente selezionati o di appartenenza.
                        </p>
                    </div>
                </div>
            </a>
        </div>

        <!-- Toponomi -->
        <div class="col-md-6 col-lg-4">
            <a asp-controller="Toponomi" asp-action="Index" class="text-decoration-none text-reset">
                <div class="card card-home h-100 shadow-sm">
                    <div class="card-body d-flex flex-column p-4">
                        <div class="d-flex align-items-center mb-3">
                            <div class="icon-circle bg-primary text-white me-3">
                                <i class="fas fa-map-marked-alt"></i>
                            </div>
                            <h5 class="card-title mb-0">Toponomi</h5>
                        </div>
                        <p class="card-text text-muted mt-auto">
                            Visualizza e amministri l’elenco completo dei toponimi associati ad un ente.
                        </p>
                    </div>
                </div>
            </a>
        </div>

        <!-- Utenze -->
        <div class="col-md-6 col-lg-4">
            <a asp-controller="Utenze" asp-action="Index" class="text-decoration-none text-reset">
                <div class="card card-home h-100 shadow-sm">
                    <div class="card-body d-flex flex-column p-4">
                        <div class="d-flex align-items-center mb-3">
                            <div class="icon-circle bg-info text-white me-3">
                                <i class="fas fa-water"></i>
                            </div>
                            <h5 class="card-title mb-0">Utenze Idriche</h5>
                        </div>
                        <p class="card-text text-muted mt-auto">
                            Consulta le utenze idriche registrate.
                        </p>
                    </div>
                </div>
            </a>
        </div>

        <!-- File INPS -->
        <div class="col-md-6 col-lg-4">
            <a asp-controller="Elaborazione" asp-action="NewProcessing" class="text-decoration-none text-reset">
                <div class="card card-home h-100 shadow-sm">
                    <div class="card-body d-flex flex-column p-4">
                        <div class="d-flex align-items-center mb-3">
                            <div class="icon-circle bg-danger text-white me-3">
                                <i class="fas fa-file-invoice"></i>
                            </div>
                            <h5 class="card-title mb-0">Nuova Elaborazione</h5>
                        </div>
                        <p class="card-text text-muted mt-auto">
                            Avvia una nuova elaborazione dei dati importando i file INPS.
                        </p>
                    </div>
                </div>
            </a>
        </div>

        <!-- Report -->
        <div class="col-md-6 col-lg-4">
            <a asp-controller="Report" asp-action="Index" class="text-decoration-none text-reset">
                <div class="card card-home h-100 shadow-sm">
                    <div class="card-body d-flex flex-column p-4">
                        <div class="d-flex align-items-center mb-3">
                            <div class="icon-circle bg-danger text-white me-3">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h5 class="card-title mb-0">Elaborazioni</h5>
                        </div>
                        <p class="card-text text-muted mt-auto">
                            Esamina l’elenco delle elaborazioni effettuate e consulta le domande associate ad esse.
                        </p>
                    </div>
                </div>
            </a>
        </div>

        <!-- Sezioni per ADMIN -->
        @if (ViewBag.Ruolo == "ADMIN")
        {
            <!-- Gestione Enti -->
            <div class="col-md-6 col-lg-4">
                <a asp-controller="Enti" asp-action="Index" class="text-decoration-none text-reset">
                    <div class="card card-home h-100 shadow-sm">
                        <div class="card-body d-flex flex-column p-4">
                            <div class="d-flex align-items-center mb-3">
                                <div class="icon-circle bg-warning text-white me-3">
                                    <i class="fas fa-building"></i>
                                </div>
                                <h5 class="card-title mb-0">Gestione Enti</h5>
                            </div>
                            <p class="card-text text-muted mt-auto">
                                Accedi alla gestione degli enti, modificando o aggiornando le informazioni degli enti.
                            </p>
                        </div>
                    </div>
                </a>
            </div>
            
            <!-- Carica Anagrafica -->
            <div class="col-md-6 col-lg-4">
                <a asp-controller="Anagrafe" asp-action="Upload" class="text-decoration-none text-reset">
                    <div class="card card-home h-100 shadow-sm">
                        <div class="card-body d-flex flex-column p-4">
                            <div class="d-flex align-items-center mb-3">
                                <div class="icon-circle bg-success text-white me-3">
                                    <i class="fas fa-users"></i>
                                </div>
                                <h5 class="card-title mb-0">Carica Anagrafica</h5>
                            </div>
                            <p class="card-text text-muted mt-auto">
                                Importa o aggiorna i dati anagrafici relativi ai soggetti registrati nel sistema.
                            </p>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Utenze Idriche -->
            <div class="col-md-6 col-lg-4">
                <a asp-controller="Utenze" asp-action="Upload" class="text-decoration-none text-reset">
                    <div class="card card-home h-100 shadow-sm">
                        <div class="card-body d-flex flex-column p-4">
                            <div class="d-flex align-items-center mb-3">
                                <div class="icon-circle bg-primary text-white me-3">
                                    <i class="fas fa-tint"></i>
                                </div>
                                <h5 class="card-title mb-0">Carica Utenze Idriche</h5>
                            </div>
                            <p class="card-text text-muted mt-auto">
                            Carica o aggiorna i dati delle utenze idriche per gli enti di competenza.
                            </p>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Utenti -->
            <div class="col-md-6 col-lg-4">
                <a asp-controller="Account" asp-action="Show" class="text-decoration-none text-reset">
                    <div class="card card-home h-100 shadow-sm">
                        <div class="card-body d-flex flex-column p-4">
                            <div class="d-flex align-items-center mb-3">
                                <div class="icon-circle bg-dark text-white me-3">
                                    <i class="fas fa-user-cog"></i>
                                </div>
                                <h5 class="card-title mb-0">Gestione Utenti</h5>
                            </div>
                            <p class="card-text text-muted mt-auto">
                                Crea o modifica gli utenti del sistema.
                            </p>
                        </div>
                    </div>
                </a>
            </div> 

            <!-- Statistiche -->
            <div class="col-md-6 col-lg-4">
                <a asp-controller="Statistiche" asp-action="Index" class="text-decoration-none text-reset">
                    <div class="card card-home h-100 shadow-sm">
                        <div class="card-body d-flex flex-column p-4">
                            <div class="d-flex align-items-center mb-3">
                                <div class="icon-circle bg-third text-white me-3">
                                    <i class="fas fa-chart-pie"></i>
                                </div>
                                <h5 class="card-title mb-0">Statistiche</h5>
                            </div>
                            <p class="card-text text-muted mt-auto">
                                Visualizza le statistiche realtive all'utilizzo del sistema.
                            </p>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Log -->
            <div class="col-md-6 col-lg-4">
                <a asp-controller="Log" asp-action="Index" class="text-decoration-none text-reset">
                    <div class="card card-home h-100 shadow-sm">
                        <div class="card-body d-flex flex-column p-4">
                            <div class="d-flex align-items-center mb-3">
                                <div class="icon-circle bg-primary text-white me-3">
                                    <i class="fas fa-history"></i>
                                </div>
                                <h5 class="card-title mb-0">Log</h5>
                            </div>
                            <p class="card-text text-muted mt-auto">
                                Accedi al registro delle operazioni per monitorare le attività svolte nel sistema.
                            </p>
                        </div>
                    </div>
                </a>
            </div>   
        }
        

        <!-- Messaggio -->
        @if (!string.IsNullOrEmpty(ViewBag.Message))
        {
            <div class="alert alert-info mt-4 shadow-sm border-0">
                <i class="bi bi-info-circle me-2"></i> @ViewBag.Message
            </div>
        }
    </div>
</div>